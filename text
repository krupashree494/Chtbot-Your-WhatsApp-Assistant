# AIzaSyB7g07gML59K_QbJI7L76GAVwMCy5jGT1A
import pyautogui
import time
import pyperclip
import google.generativeai as genai

genai.configure(api_key="AIzaSyB7g07gML59K_QbJI7L76GAVwMCy5jGT1A")

def aiProcess(command):
    """Generates a response where AI continues the conversation."""
    try:
        model = genai.GenerativeModel("gemini-1.5-pro-latest")  # Ensure model is available

        response = model.generate_content(
            f"You are Rani. Respond naturally as if you are continuing the conversation.\n\n{command}"
        )
        
        return response.text  # Return AI-generated continuation

    except Exception as e:
        return f"Error: {str(e)}"

# Wait for a moment to switch to the required window
time.sleep(2)

# Click on the icon at (1388,1046)
pyautogui.click(1388, 1046)

time.sleep(1)  # Wait for any response

# Drag to select text from (675,266) to (1835,902)
pyautogui.moveTo(675, 266)
pyautogui.mouseDown()
pyautogui.moveTo(1835, 902, duration=0.5)
pyautogui.mouseUp()

time.sleep(0.5)  # Allow some time for selection

# Copy the selected text to clipboard
pyautogui.hotkey('ctrl', 'c')

# Click to deselect the content
pyautogui.click(1846, 877)

time.sleep(0.5)  # Wait for text to be copied

# Retrieve the copied text
copied_text = pyperclip.paste()

# Print the copied text
print("Copied Text:", copied_text)

if __name__ == "__main__":
    output = aiProcess(copied_text)
    print("\nAI Response (Rani Reply):\n", output)